<p>Hier kannst du eine Predigtaufnahme hochladen, die dann automatisch einer Predigt zugeordnet wird. Angezeigt werden nur Predigten, f√ºr die noch keine Aufnahme hinterlegt ist.</p>
<f:form enctype="multipart/form-data" controller="Sermon" action="audioUploadDone">
    <label for="sermon">Predigt: </label><f:form.select name="sermon" options="{sermons}" optionLabelField="selectString" /><br />
    <label for="audiorecording">Aufnahme: </label><f:form.upload id="audiorecording" name="audiorecording" /><br />
    
    <div id="fileuploader">Aufnahme hochladen</div>
    
    <f:form.button id="origUploadButton">Hochladen</f:form.button>
    
<script>
    $(document).ready(function(){
		$("#fileuploader").uploadFile({
			url:'<f:uri.action controller="Sermon" action="audioUploadDone" />',
			fileName:'tx_vmfdssermons_sermons[audiorecording]',
			downloadStr:'Hochladen',
			cancelStr:'Abbrechen',
			abortStr:'Abbrechen',
			doneStr:'Fertig',
			dragDropStr: "<span><b>... oder eine Datei hierher ziehen.</b></span>",
			maxFileCount:1,
			maxFileSize: 100*1024*1024,
			multiple: false,
			dynamicFormData: function(){
				var data = {
					    'tx_vmfdssermons_sermons[__referrer][@extension]':'VmfdsSermons',
					    'tx_vmfdssermons_sermons[__referrer][@vendor]':'TYPO3',
					    'tx_vmfdssermons_sermons[__referrer][@controller]':'Sermon',
					    'tx_vmfdssermons_sermons[__referrer][@action]':'audioUploadWelcome',
					    'tx_vmfdssermons_sermons[__referrer][arguments]':$("input[name='tx_vmfdssermons_sermons[__referrer][arguments]']").val(),
					    'tx_vmfdssermons_sermons[__trustedProperties]':$("input[name='tx_vmfdssermons_sermons[__trustedProperties]']").val(),
					    'tx_vmfdssermons_sermons[sermon]':$("select[name='tx_vmfdssermons_sermons[sermon]']").val()
					}
				return data;
			},
			afterUploadAll:function(){
			    window.location.href = '<f:uri.action controller="Sermon" action="audioUploadWelcome" />';
			}
		});
		$('#audiorecording').hide();
		$('#origUploadButton').hide();
	});
    
</script>
</f:form>